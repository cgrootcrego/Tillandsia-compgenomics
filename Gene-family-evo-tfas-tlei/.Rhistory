install.packages("pacman")
library(ggplot2)
library(dplyr)
setwd("/home/clara/Documents/GitHub/Tillandsia-compgenomics/Gene-family-evo-tfas-tlei/")
counts <- read.table("orthogroups_Tfas_Tlei_Acom.counts.with_functional_info.no_TEs.size_corrections.no_plastid-mito-ribo.blastandsearch.txt", sep = '\t')
colnames(counts) <- c("og_id", "Acom", "Tfas", "Tlei")
per_gene <- read.delim("orthogroups_Tfas_Tlei_Acom.per_gene.with_functional_info.no_TEs.size_corrections.no_plastid-mito-ribo.blastandsearch_noAcom.txt",
sep = "\t", header = F)
# Filter out unique orthogroups
counts_Tfas_Tlei <- counts[counts$Tfas != 0 & counts$Tlei != 0,]
ggplot(counts_Tfas_Tlei, aes(x=Tfas, y=Tlei)) + geom_point(size = .5) +
geom_abline(intercept = 0, slope = 1) +
labs(title = "Per-species gene counts in multi-copy orthogroups") +
ylab(label = "T. leiboldiana") +
xlab(label = "T. fasciculata") +
theme_bw()
### Log-ratio test
counts_Tfas_Tlei$logratio <- log(counts_Tfas_Tlei$Tfas/counts_Tfas_Tlei$Tlei)
mean_logratio <- mean(counts_Tfas_Tlei$logratio) # 0.0203
counts_Tfas_Tlei$corr_logratio <- counts_Tfas_Tlei$logratio - mean_logratio
View(counts_Tfas_Tlei)
ggplot(counts_Tfas_Tlei, aes(x=corr_logratio)) + geom_density()
ggplot(counts_Tfas_Tlei, aes(x=corr_logratio)) + geom_density() +
xlim(-1.1)
ggplot(counts_Tfas_Tlei, aes(x=corr_logratio)) + geom_density() +
xlim(c(-1,1))
ggplot(counts_Tfas_Tlei, aes(x=corr_logratio)) + geom_density()
quantiles(counts_Tfas_Tlei$corr_logratio)
quantile(counts_Tfas_Tlei$corr_logratio)
